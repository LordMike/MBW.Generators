# MBW.Generators.OverloadGenerator

## About
Generates overloads for methods based on declarative attributes. Apply attributes to a method or containing type and the generator emits additional overloads that either transform a parameter or supply a default value. This is useful when you want a terse public API but still allow callers to pass richer types.

Imagine an API that accepts a string kind and an optional retry flag. Callers might prefer passing an `OrderKind` enum instead of remembering the string representation, and most will keep the retry flag at its default.

## Quick Start
- Install the `MBW.Generators.OverloadGenerator` package.
- Decorate your partial class or individual methods with `[TransformOverload]` or `[DefaultOverload]`.
- The generator emits overloads for decorated methods, preserving visibility, parameter names, generic constraints, and default parameter values while keeping extension methods as extensions.

The package includes both the attributes and the source generator.

## Example
```csharp
using MBW.Generators.OverloadGenerator;
using MBW.Generators.OverloadGenerator.Attributes;

public enum OrderKind { Standard, Express }

[TransformOverload("kind", typeof(OrderKind), "{value}.ToString(\"G\", System.Globalization.CultureInfo.InvariantCulture)")]
[DefaultOverload("retry", "true")]
public partial class Orders
{
    public void Create(string kind, bool retry) { }
}
```
Generates
```csharp
// <auto-generated/>

partial class Orders
{
    public void Create(global::OrderKind kind, bool retry)
        => Create(kind.ToString("G", System.Globalization.CultureInfo.InvariantCulture), retry);

    public void Create(string kind)
        => Create(kind, true);
}
```

## Features
- Replace parameters with strongly typed alternatives or supply defaults.
- Apply attributes at type or method level for flexible targeting.
- Supports extension methods and generic types, preserving generic constraints and default parameter values.
- Uses incremental generators for performance.
- Emits diagnostics to help guide usage, including signature collisions, missing parameters, invalid `accept` types, missing `{value}` tokens, and attempts to remove the `this` receiver of an extension method.
- Preserves original method visibility and parameter names.
- Generates interface members with default bodies where applicable.

## Attributes
- **TransformOverloadAttribute** – apply to a type or method. Replaces a string parameter with a strongly typed version. Parameters:
  - `parameter` – the name of the parameter to replace.
  - `accept` – the type callers can supply. Unsupported types produce a diagnostic.
  - `transform` – an expression where `{value}` is substituted with the parameter.
  - `newTypeNullability` – optionally mark the new type as nullable.
  - `methodNameMatch` / `methodNameReplace` – regex pair for renaming generated methods.
- **DefaultOverloadAttribute** – apply to a type or method. Emits an overload that supplies a default expression when the specified parameter is omitted. Parameters:
  - `parameter` – the name of the parameter to default.
  - `defaultExpression` – expression inserted for the missing argument.
  - `methodNameMatch` / `methodNameReplace` – regex pair for renaming generated methods.

Removing the `this` receiver of an extension method is not supported and will trigger a diagnostic.

Both attributes may appear multiple times and are not inherited.

## More information
This project is provided as-is without support. Further usage examples can be found in the [tests](../OverloadGenerator.Tests).
